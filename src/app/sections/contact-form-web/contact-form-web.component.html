<section class="contact">
  <span id="contact-form-web" class="anchor" aria-hidden="true"></span>
  <h3 class="contact__headline">{{ 'CONTACTFORM.HEADLINE' | translate }}</h3>

  <form #f="ngForm" class="contact__grid" (ngSubmit)="onSubmit(f)" novalidate autocomplete="off">
    <div class="field field--name">
      <label class="sr-only" for="name">{{ 'CONTACTFORM.NAME' | translate }}</label>
      <div class="field__box">
        <input id="name" name="name" type="text" class="field__control" [placeholder]="'CONTACTFORM.NAME' | translate"
          [(ngModel)]="model.name" #nameCtrl="ngModel" required minlength="2" autocomplete="off" (input)="onInput()"
          [attr.aria-invalid]="(nameCtrl.touched || nameCtrl.dirty) && !!errors.name ? 'true' : null" />
        <span class="field__ok" *ngIf="nameCtrl.touched && !errors.name" aria-hidden="true"></span>
      </div>
      <span class="error-inline error-inline--below" *ngIf="(nameCtrl.touched || nameCtrl.dirty) && errors.name">
        <i>*</i> {{ errors.name | translate }}
      </span>
    </div>

    <div class="field field--email">
      <label class="sr-only" for="email">{{ 'CONTACTFORM.EMAIL' | translate }}</label>
      <div class="field__box">
        <input id="email" name="email" type="email" class="field__control"
          [placeholder]="'CONTACTFORM.EMAIL' | translate" [(ngModel)]="model.email" #emailCtrl="ngModel" required
          autocomplete="off" (input)="onInput()
          " [attr.aria-invalid]="(emailCtrl.touched || emailCtrl.dirty) && !!errors.email ? 'true' : null" />
        <span class="field__ok" *ngIf="emailCtrl.touched && !errors.email" aria-hidden="true"></span>
      </div>
      <span class="error-inline error-inline--below" *ngIf="(emailCtrl.touched || emailCtrl.dirty) && errors.email">
        <i>*</i> {{ errors.email | translate }}
      </span>
    </div>

    <div class="field field--message">
      <label class="sr-only" for="message">{{ 'CONTACTFORM.MESSAGE' | translate }}</label>
      <div class="field__box">
        <textarea id="message" name="message" class="field__control" [placeholder]="'CONTACTFORM.MESSAGE' | translate"
          [(ngModel)]="model.message" #msgCtrl="ngModel" required minlength="10" autocomplete="off" (input)="onInput()"
          [attr.aria-invalid]="(msgCtrl.touched || msgCtrl.dirty) && !!errors.message ? 'true' : null"></textarea>
        <span class="field__ok" *ngIf="msgCtrl.touched && !errors.message" aria-hidden="true"></span>
      </div>
      <span class="error-inline error-inline--below" *ngIf="(msgCtrl.touched || msgCtrl.dirty) && errors.message">
        <i>*</i> {{ errors.message | translate }}
      </span>
    </div>

    <div class="consent">
      <label class="check">
        <input class="check__control" type="checkbox" name="accepted" [(ngModel)]="accepted" #accCtrl="ngModel" required
          (change)="onAcceptChange()" />
        <span>
          {{ 'CONTACTFORM.PRIVACY' | translate }}
          <a class="check__link" routerLink="/privacy">{{ 'CONTACTFORM.PRIVACY_LINK' | translate }}</a>
          {{ 'CONTACTFORM.PRIVACY_AGREE' | translate }}
        </span>
      </label>

      <div class="error-inline error-inline--below" *ngIf="(accCtrl.touched || accCtrl.dirty) && errors.accepted">
        <i>*</i> {{ errors.accepted | translate }}
      </div>
    </div>

    <div class="field">
      <div class="contact__button-wrap">
        <button type="submit" class="send-btn" [disabled]="isSending || !allValid"
          [ngClass]="{ 'is-accepted': accepted, 'is-valid': allValid }">
          {{ isSending ? ('CONTACTFORM.SENDING' | translate) : ('CONTACTFORM.SUBMIT' | translate) }}
        </button>

        <ng-content></ng-content>
      </div>
    </div>
  </form>

  <div *ngIf="toast.show" class="toast-backdrop" (click)="closeToast()">
    <div class="toast" role="alertdialog" aria-live="assertive" aria-modal="true" (click)="$event.stopPropagation()"
      [class.toast--success]="toast.kind === 'success'" [class.toast--error]="toast.kind === 'error'">
      <div class="toast__icon" aria-hidden="true">
        <span *ngIf="toast.kind==='success'">✓</span>
        <span *ngIf="toast.kind==='error'">!</span>
      </div>
      <div class="toast__content">
        <strong *ngIf="toast.kind==='success'">{{ 'CONTACTFORM.HEADLINE' | translate }}</strong>
        <p>{{ toast.msgKey | translate }}</p>
      </div>
      <button class="toast__close" type="button" (click)="closeToast()" aria-label="Close">×</button>
    </div>
  </div>
</section>